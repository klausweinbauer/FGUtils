

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>References &mdash; FGUtils  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Proxy Collection" href="proxy_collection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            FGUtils
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="functional_groups.html">Functional Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_syntax.html">Graph Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy_collection.html">Proxy Collection</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.algorithm.subgraph">algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.algorithm.subgraph.map_anchored_subgraph"><code class="docutils literal notranslate"><span class="pre">map_anchored_subgraph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.algorithm.subgraph.map_subgraph"><code class="docutils literal notranslate"><span class="pre">map_subgraph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.algorithm.subgraph_enumeration.node_induced_connected_subgraphs"><code class="docutils literal notranslate"><span class="pre">node_induced_connected_subgraphs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.data.loader">data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.data.loader.CSVLoader"><code class="docutils literal notranslate"><span class="pre">CSVLoader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.data.loader.CSVReactionLoader"><code class="docutils literal notranslate"><span class="pre">CSVReactionLoader</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.fgconfig">fgconfig</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.fgconfig.FGConfig"><code class="docutils literal notranslate"><span class="pre">FGConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.fgconfig.FGConfig.pattern_len"><code class="docutils literal notranslate"><span class="pre">FGConfig.pattern_len</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.fgconfig.FGConfigProvider"><code class="docutils literal notranslate"><span class="pre">FGConfigProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.fgconfig.FGConfigProvider.get_by_name"><code class="docutils literal notranslate"><span class="pre">FGConfigProvider.get_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.fgconfig.FGConfigProvider.get_tree"><code class="docutils literal notranslate"><span class="pre">FGConfigProvider.get_tree()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.its">its</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.ITS"><code class="docutils literal notranslate"><span class="pre">ITS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.from_smiles"><code class="docutils literal notranslate"><span class="pre">ITS.from_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.prune"><code class="docutils literal notranslate"><span class="pre">ITS.prune()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.remove_reagents"><code class="docutils literal notranslate"><span class="pre">ITS.remove_reagents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.split"><code class="docutils literal notranslate"><span class="pre">ITS.split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.standardize"><code class="docutils literal notranslate"><span class="pre">ITS.standardize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.its.ITS.to_smiles"><code class="docutils literal notranslate"><span class="pre">ITS.to_smiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.get_its"><code class="docutils literal notranslate"><span class="pre">get_its()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.get_rc"><code class="docutils literal notranslate"><span class="pre">get_rc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.prune_its_to_rc"><code class="docutils literal notranslate"><span class="pre">prune_its_to_rc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.remove_reagents"><code class="docutils literal notranslate"><span class="pre">remove_reagents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.its.split_its"><code class="docutils literal notranslate"><span class="pre">split_its()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.parse">parse</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.parse.Parser"><code class="docutils literal notranslate"><span class="pre">Parser</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.parse.Parser.parse"><code class="docutils literal notranslate"><span class="pre">Parser.parse()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.permutation">permutation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.permutation.MappingMatrix"><code class="docutils literal notranslate"><span class="pre">MappingMatrix</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.permutation.MappingMatrix.is_mapping"><code class="docutils literal notranslate"><span class="pre">MappingMatrix.is_mapping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.permutation.MappingMatrix.min_mapping_symbol"><code class="docutils literal notranslate"><span class="pre">MappingMatrix.min_mapping_symbol()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.permutation.PermutationMapper"><code class="docutils literal notranslate"><span class="pre">PermutationMapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.proxy">proxy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.GraphSampler"><code class="docutils literal notranslate"><span class="pre">GraphSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.GraphSampler.sample"><code class="docutils literal notranslate"><span class="pre">GraphSampler.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.MolProxy"><code class="docutils literal notranslate"><span class="pre">MolProxy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.Proxy"><code class="docutils literal notranslate"><span class="pre">Proxy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.Proxy.from_dict"><code class="docutils literal notranslate"><span class="pre">Proxy.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.Proxy.get_next"><code class="docutils literal notranslate"><span class="pre">Proxy.get_next()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.Proxy.groups"><code class="docutils literal notranslate"><span class="pre">Proxy.groups</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.ProxyGraph"><code class="docutils literal notranslate"><span class="pre">ProxyGraph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.ProxyGroup"><code class="docutils literal notranslate"><span class="pre">ProxyGroup</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.ProxyGroup.from_dict"><code class="docutils literal notranslate"><span class="pre">ProxyGroup.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.ProxyGroup.from_dict_single"><code class="docutils literal notranslate"><span class="pre">ProxyGroup.from_dict_single()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.ProxyGroup.graphs"><code class="docutils literal notranslate"><span class="pre">ProxyGroup.graphs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.ProxyGroup.sample_graphs"><code class="docutils literal notranslate"><span class="pre">ProxyGroup.sample_graphs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.ReactionProxy"><code class="docutils literal notranslate"><span class="pre">ReactionProxy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.proxy.ReactionProxy.get_next"><code class="docutils literal notranslate"><span class="pre">ReactionProxy.get_next()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.build_graphs"><code class="docutils literal notranslate"><span class="pre">build_graphs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.build_group_tree"><code class="docutils literal notranslate"><span class="pre">build_group_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.replace_next_node"><code class="docutils literal notranslate"><span class="pre">replace_next_node()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy.replace_node"><code class="docutils literal notranslate"><span class="pre">replace_node()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.proxy_collection.common">proxy_collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.proxy_collection.diels_alder_proxy.DielsAlderProxy"><code class="docutils literal notranslate"><span class="pre">DielsAlderProxy</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.query">query</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.query.FGQuery"><code class="docutils literal notranslate"><span class="pre">FGQuery</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.query.FGQuery.get"><code class="docutils literal notranslate"><span class="pre">FGQuery.get()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.rdkit">rdkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.get_mol_coords"><code class="docutils literal notranslate"><span class="pre">get_mol_coords()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.graph_to_mol"><code class="docutils literal notranslate"><span class="pre">graph_to_mol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.graph_to_smiles"><code class="docutils literal notranslate"><span class="pre">graph_to_smiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.mol_smiles_to_graph"><code class="docutils literal notranslate"><span class="pre">mol_smiles_to_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.mol_to_graph"><code class="docutils literal notranslate"><span class="pre">mol_to_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.reaction_smiles_to_graph"><code class="docutils literal notranslate"><span class="pre">reaction_smiles_to_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.rdkit.smiles_to_graph"><code class="docutils literal notranslate"><span class="pre">smiles_to_graph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.synthesis.rule_application">synthesis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.synthesis.rule_application.DPORule"><code class="docutils literal notranslate"><span class="pre">DPORule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.synthesis.rule_application.DPORule.to_rc_graph"><code class="docutils literal notranslate"><span class="pre">DPORule.to_rc_graph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.synthesis.rule_application.ReactionRule"><code class="docutils literal notranslate"><span class="pre">ReactionRule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.synthesis.rule_application.ReactionRule.from_gml"><code class="docutils literal notranslate"><span class="pre">ReactionRule.from_gml()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.synthesis.rule_application.apply_rule"><code class="docutils literal notranslate"><span class="pre">apply_rule()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.synthesis.rule_application.its_to_gml"><code class="docutils literal notranslate"><span class="pre">its_to_gml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.synthesis.rule_application.parse_gml_dpo_rule"><code class="docutils literal notranslate"><span class="pre">parse_gml_dpo_rule()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.torch.ITSDataset">torch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.ITSDataset.ITSDataset"><code class="docutils literal notranslate"><span class="pre">ITSDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.TUDataset.TUDataset"><code class="docutils literal notranslate"><span class="pre">TUDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.torch.TUDataset.TUDataset.download"><code class="docutils literal notranslate"><span class="pre">TUDataset.download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.torch.TUDataset.TUDataset.process"><code class="docutils literal notranslate"><span class="pre">TUDataset.process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.torch.TUDataset.TUDataset.processed_file_names"><code class="docutils literal notranslate"><span class="pre">TUDataset.processed_file_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fgutils.torch.TUDataset.TUDataset.raw_file_names"><code class="docutils literal notranslate"><span class="pre">TUDataset.raw_file_names</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.graph.edge_induced_subgraph"><code class="docutils literal notranslate"><span class="pre">edge_induced_subgraph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.graph.node_induced_subgraph"><code class="docutils literal notranslate"><span class="pre">node_induced_subgraph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.utils.get_adjacency_matrix"><code class="docutils literal notranslate"><span class="pre">get_adjacency_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.utils.its_from_torch"><code class="docutils literal notranslate"><span class="pre">its_from_torch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.utils.its_to_torch"><code class="docutils literal notranslate"><span class="pre">its_to_torch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.utils.prune"><code class="docutils literal notranslate"><span class="pre">prune()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.torch.utils.prune_rc"><code class="docutils literal notranslate"><span class="pre">prune_rc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.add_implicit_hydrogens"><code class="docutils literal notranslate"><span class="pre">add_implicit_hydrogens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.complete_aam"><code class="docutils literal notranslate"><span class="pre">complete_aam()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.get_product"><code class="docutils literal notranslate"><span class="pre">get_product()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.get_reactant"><code class="docutils literal notranslate"><span class="pre">get_reactant()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.get_unreachable_nodes"><code class="docutils literal notranslate"><span class="pre">get_unreachable_nodes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.initialize_aam"><code class="docutils literal notranslate"><span class="pre">initialize_aam()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.mol_equal"><code class="docutils literal notranslate"><span class="pre">mol_equal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.remove_implicit_hydrogens"><code class="docutils literal notranslate"><span class="pre">remove_implicit_hydrogens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fgutils.utils.split_its"><code class="docutils literal notranslate"><span class="pre">split_its()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fgutils.vis">vis</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FGUtils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">References</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/references.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading"></a></h1>
<section id="module-fgutils.algorithm.subgraph">
<span id="algorithm"></span><h2>algorithm<a class="headerlink" href="#module-fgutils.algorithm.subgraph" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fgutils.algorithm.subgraph.map_anchored_subgraph">
<span class="sig-prename descclassname"><span class="pre">fgutils.algorithm.subgraph.</span></span><span class="sig-name descname"><span class="pre">map_anchored_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgraph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgraph_anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><span class="pre">PermutationMapper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.algorithm.subgraph.map_anchored_subgraph" title="Link to this definition"></a></dt>
<dd><p>Map an anchored subgraph into an anchored parent graph. The anchor in
the subgraph and the anchor in the parent graph is the first fixed mapping.
The subgraph is aligned to the parent graph based on this anchor. This
function will only find one alignment and not all possible alignments. It
will return once a solution is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The paraent graph in which to align the subgraph.</p></li>
<li><p><strong>anchor</strong> – The node index for the anchor in the parent graph.</p></li>
<li><p><strong>subgraph</strong> – The subgraph to align in the parent.</p></li>
<li><p><strong>subgraph_anchor</strong> – The node index for the anchor in the subgraph.</p></li>
<li><p><strong>mapper</strong> – A <a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PermutationMapper</span></code></a>
instance. The permutation mapper specifies which nodes in the subgraph
can align with nodes in the parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns a 3-tuple of the form <code class="docutils literal notranslate"><span class="pre">(is_valid,</span> <span class="pre">mapping,</span>
<span class="pre">visited_nodes)</span></code>. The first entry <code class="docutils literal notranslate"><span class="pre">is_valid</span></code> is a boolean indicating
if a mapping was found. The second entry <code class="docutils literal notranslate"><span class="pre">mapping</span></code> is a list of
integer tuples. Each integer tuple encodes one node mapping where the
first element is the node index in the parent graph and the second
entry is the node index in the subgraph. The third element is a tuple
of sets with node indices for the visited nodes during graph alignment
in the subgraph and parent graph, respectively.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.algorithm.subgraph.map_subgraph">
<span class="sig-prename descclassname"><span class="pre">fgutils.algorithm.subgraph.</span></span><span class="sig-name descname"><span class="pre">map_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgraph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><span class="pre">PermutationMapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgraph_anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.algorithm.subgraph.map_subgraph" title="Link to this definition"></a></dt>
<dd><p>Finds an anchored map of a subgraph in a parent graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anchor</strong> – The node index in the parent graph where the subgraph is
anchored.</p></li>
<li><p><strong>subgraph</strong> – The subgraph to align at the anchor node.</p></li>
<li><p><strong>mapper</strong> – A <a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PermutationMapper</span></code></a>
instance. The permutation mapper specifies which nodes in the subgraph
can align with nodes in the parent.</p></li>
<li><p><strong>subgraph_anchor</strong> – (Optional) A node index in the subgraph for a fixed
anchor. If provided this is the first fixed mapping between subgraph
and parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of tuples: [(is_valid, mapping)]. Each list entry
corresponds to one subgraph mapping. The first element in the tuple is
a boolean indicating if a mapping was found. The second element is the
mapping. The mapping is a list of integer 2-tuples where the first
element is the node index in the subgraph and the second element is the
node index in the parent graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-fgutils.algorithm.subgraph_enumeration">
<dt class="sig sig-object py" id="fgutils.algorithm.subgraph_enumeration.node_induced_connected_subgraphs">
<span class="sig-prename descclassname"><span class="pre">fgutils.algorithm.subgraph_enumeration.</span></span><span class="sig-name descname"><span class="pre">node_induced_connected_subgraphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DAG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.algorithm.subgraph_enumeration.node_induced_connected_subgraphs" title="Link to this definition"></a></dt>
<dd><p>Iterates over all node induced anchored connected subgraphs. The
generation of new subgraphs has linear delay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – The networkx.Graph to get connected subgraphs from.</p></li>
<li><p><strong>anchor</strong> – The node index to use as anchor.</p></li>
<li><p><strong>DAG</strong> – (optional) An empty networkx.DiGraph where the extension DAG is
generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a generator to get all connected induced subgraphs. The
return type of a single iteration is a list of node indices that form a
connected induced subgraph.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.data.loader">
<span id="data"></span><h2>data<a class="headerlink" href="#module-fgutils.data.loader" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.data.loader.CSVLoader">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.data.loader.</span></span><span class="sig-name descname"><span class="pre">CSVLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.data.loader.CSVLoader" title="Link to this definition"></a></dt>
<dd><p>The base class for loading CSV files. This class is a generator and can
directly be used in a for loop. The returned column values are in the order
in which they were specified in the columns argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> – File to the CSV file.</p></li>
<li><p><strong>columns</strong> – Single column or list of columns to read from CSV file.</p></li>
<li><p><strong>delimiter</strong> – (optional) The CSV delimiter. Default: “,”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.data.loader.CSVReactionLoader">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.data.loader.</span></span><span class="sig-name descname"><span class="pre">CSVReactionLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reaction_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.data.loader.CSVReactionLoader" title="Link to this definition"></a></dt>
<dd><p>Load SMILES reactions from CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> – The path to the CSV file.</p></li>
<li><p><strong>reaction_col</strong> – The column where to find the SMILES reaction.</p></li>
<li><p><strong>id_col</strong> – (optional) An id column. Default: None</p></li>
<li><p><strong>mode</strong> – <p>(optional) Defines how reactions and molecules are loaded.
Available modes are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;GH&quot;</span></code>: Loads the reactant and product molecules as graphs. The
reaction is returned in the form G → H.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;SMILES&quot;</span></code>: Loads the reaction as SMILES.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ITS&quot;</span></code>: Loads the reaction as <a class="reference internal" href="#fgutils.its.ITS" title="fgutils.its.ITS"><code class="xref py py-class docutils literal notranslate"><span class="pre">ITS</span></code></a> graph.
The SMILES must have annotated atom-atom maps.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.fgconfig">
<span id="fgconfig"></span><h2>fgconfig<a class="headerlink" href="#module-fgutils.fgconfig" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.fgconfig.FGConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.fgconfig.</span></span><span class="sig-name descname"><span class="pre">FGConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anti_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_exclude_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['R']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.fgconfig.FGConfig" title="Link to this definition"></a></dt>
<dd><p>Functional group configuration class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the functional gruop.</p></li>
<li><p><strong>pattern</strong> – The structural description of the functional group.</p></li>
<li><p><strong>parser</strong> – (optional) A parser to use to convert the pattern into a
structure.</p></li>
<li><p><strong>group_atoms</strong> – (optional) A list of indices indicating with nodes in
the pattern belong to the functional group. A pattern might have some
wildcard nodes attached that are required to match but do not belong to
the group. (Default = all nodes)</p></li>
<li><p><strong>anti_pattern</strong> – (optional) A list of anti patterns that must not be
matched. (Default = None)</p></li>
<li><p><strong>depth</strong> – (optional) The maximal depth to check the patterns. (Default
= max(pattern, anti_pattern)</p></li>
<li><p><strong>len_exclude_nodes</strong> – (optional) Node types that should be excluded in
the pattern length. (Default = [“R”] - wildcard pattern)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fgutils.fgconfig.FGConfig.pattern_len">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pattern_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fgutils.fgconfig.FGConfig.pattern_len" title="Link to this definition"></a></dt>
<dd><p>The number of nodes of the functional group structure. Nodes
specified in <code class="docutils literal notranslate"><span class="pre">len_exclude_nodes</span></code> are not included.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.fgconfig.FGConfigProvider">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.fgconfig.</span></span><span class="sig-name descname"><span class="pre">FGConfigProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.fgconfig.FGConfig" title="fgutils.fgconfig.FGConfig"><span class="pre">FGConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.fgconfig.FGConfig" title="fgutils.fgconfig.FGConfig"><span class="pre">FGConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><span class="pre">PermutationMapper</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.fgconfig.FGConfigProvider" title="Link to this definition"></a></dt>
<dd><p>Provider for functional group configs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – A FGConfig object or a list of config objects. The
configurations can also be passed as dictionaries.</p></li>
<li><p><strong>mapper</strong> – (optional) A PermutationMapper to use.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.fgconfig.FGConfigProvider.get_by_name">
<span class="sig-name descname"><span class="pre">get_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fgutils.fgconfig.FGConfig" title="fgutils.fgconfig.FGConfig"><span class="pre">FGConfig</span></a></span></span><a class="headerlink" href="#fgutils.fgconfig.FGConfigProvider.get_by_name" title="Link to this definition"></a></dt>
<dd><p>Get the functional group config by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the FGConfig instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.fgconfig.FGConfigProvider.get_tree">
<span class="sig-name descname"><span class="pre">get_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">FGTreeNode</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.fgconfig.FGConfigProvider.get_tree" title="Link to this definition"></a></dt>
<dd><p>Get the functional groups hirachically organized in a tree.
Functional groups are ordered based on their structure. A group is
another groups child if its structure is more specific, i.e., the
parent structure is a subgraph of the child. A child can have multiple
parents and a parent can have multiple childs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the list of root groups.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fgutils.its">
<span id="its"></span><h2>its<a class="headerlink" href="#module-fgutils.its" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.its.ITS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">ITS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.ITS" title="Link to this definition"></a></dt>
<dd><p>Imaginary Transition State graph class. Superposition graph of
reactants and products in a chemical reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong> – The raw ITS graph.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.from_smiles">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.ITS.from_smiles" title="Link to this definition"></a></dt>
<dd><p>Construct an ITS graph from an atom-atom mapped reaction smiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> – An atom-atom mapped reaction smiles.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the ITS graph of the reaction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.prune">
<span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.ITS.prune" title="Link to this definition"></a></dt>
<dd><p>Prune the ITS graph to its reaction center and some context. The
context is defined by a radius. Radius 0 gives only the reaction
center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> – The size of the context around the reaction center.
(Default: 0)</p></li>
<li><p><strong>insert_hydrogens</strong> – If true, removed nodes will be replaced by
hydrogen atoms if were adjacent to kept nodes. This ensures that the
result is still a valid molecular graph. (Default: True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.remove_reagents">
<span class="sig-name descname"><span class="pre">remove_reagents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.ITS.remove_reagents" title="Link to this definition"></a></dt>
<dd><p>Remove all reagents from the ITS graph. These are all compounds that
are not connected to the reaction center.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the new ITS graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.its.ITS.split" title="Link to this definition"></a></dt>
<dd><p>Split the ITS graph into reactant graph G and product graph H.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns G and H as tuple.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.ITS.standardize" title="Link to this definition"></a></dt>
<dd><p>Convert ITS graph into standard format and fix all type issues.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.its.ITS.to_smiles">
<span class="sig-name descname"><span class="pre">to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fgutils.its.ITS.to_smiles" title="Link to this definition"></a></dt>
<dd><p>Convert the ITS graph into a reaction smiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ignore_aam</strong> – If set to True the returned SMILES has no atom-atom
map.</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the reaction smiles.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.its.get_its">
<span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">get_its</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.its.get_its" title="Link to this definition"></a></dt>
<dd><p>Get the ITS graph of reaction G → H. G and H must be molecular
graphs with node labels ‘aam’ and ‘symbol’ and bond label ‘bond’. The
resulting ITS might be a partial ITS depending on the intersection of aam
numbers in G and H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Reactant molecular graph.</p></li>
<li><p><strong>H</strong> – Product molecular graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the ITS graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.its.get_rc">
<span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">get_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ITS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.its.get_rc" title="Link to this definition"></a></dt>
<dd><p>Get the reaction center (RC) graph from an ITS graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ITS</strong> – The ITS graph to get the RC from.</p></li>
<li><p><strong>symbol_key</strong> – (optional) The node label that encodes atom symbols on
the molecular graph.</p></li>
<li><p><strong>bond_key</strong> – (optional) The edge label that encodes bond order on the
molecular graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the reaction center (RC) graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.its.prune_its_to_rc">
<span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">prune_its_to_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">its</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.prune_its_to_rc" title="Link to this definition"></a></dt>
<dd><p>Prune an ITS graph to its reaction center and some context. The context
is defined by a radius. Radius 0 gives only the reaction center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>its</strong> – The ITS graph to prune.</p></li>
<li><p><strong>radius</strong> – The size of the context around the reaction center.
(Default: 0)</p></li>
<li><p><strong>insert_hydrogens</strong> – If true, removed nodes will be replaced by
hydrogen atoms if were adjacent to kept nodes. This ensures that the
result is still a valid molecular graph. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pruned ITS graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.its.remove_reagents">
<span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">remove_reagents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">its</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.its.remove_reagents" title="Link to this definition"></a></dt>
<dd><p>Remove all reagents from the ITS graph. These are all compounds that
are not connected to the reaction center.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the new ITS graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.its.split_its">
<span class="sig-prename descclassname"><span class="pre">fgutils.its.</span></span><span class="sig-name descname"><span class="pre">split_its</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.its.split_its" title="Link to this definition"></a></dt>
<dd><p>Split an ITS graph into reactant graph G and product graph H. Required
labels on the ITS graph are BOND_KEY.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong> – ITS graph to split up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of two graphs (G, H).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.parse">
<span id="parse"></span><h2>parse<a class="headerlink" href="#module-fgutils.parse" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.parse.Parser">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.parse.</span></span><span class="sig-name descname"><span class="pre">Parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_multigraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.parse.Parser" title="Link to this definition"></a></dt>
<dd><p>Class to convert a SMILES like graph description into a NetworkX graph.</p>
<p>Example for parsing acetic acid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">Parser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="s2">&quot;CC(O)=O&quot;</span><span class="p">)</span>
<span class="go">Graph with 4 nodes and 3 edges</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_multigraph</strong> – Flag to specify if the resulting graph object should
be of type networkx.MultiGraph or networkx.Graph. The difference is
that a MultiGraph can have more than one edge between two nodes. For
parsing molecule like graphs this is not necessary because bond types
are encoded as edge labels. (Default = False)</p></li>
<li><p><strong>verbose</strong> – Flag to print information during parsing. (Default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.parse.Parser.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.parse.Parser.parse" title="Link to this definition"></a></dt>
<dd><p>Method to parse a SMILES like graph pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – The pattern to convert into a graph. The pattern is a
tree-like description of the graph. It is strongly oriented at the
SMILES notation.</p></li>
<li><p><strong>idx_offset</strong> – The index offset argument provides the starting
value for the consecutive node numbering. (Default = 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the converted graph object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fgutils.permutation">
<span id="permutation"></span><h2>permutation<a class="headerlink" href="#module-fgutils.permutation" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.permutation.MappingMatrix">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.permutation.</span></span><span class="sig-name descname"><span class="pre">MappingMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><span class="pre">PermutationMapper</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.permutation.MappingMatrix" title="Link to this definition"></a></dt>
<dd><p>A class for fast label mapping evaluation according to a
<a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PermutationMapper</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern_symbols</strong> – A complete list of all possible pattern labels.</p></li>
<li><p><strong>structure_symbols</strong> – A complete list of all possible symbol labels.</p></li>
<li><p><strong>mapper</strong> – A PermutationMapper instance. The matrix is constructed
based on these mappings.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.permutation.MappingMatrix.is_mapping">
<span class="sig-name descname"><span class="pre">is_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fgutils.permutation.MappingMatrix.is_mapping" title="Link to this definition"></a></dt>
<dd><p>Check if two symbols can match, i.e., two nodes with respective
label can be mapped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern_symbol</strong> – The pattern symbol to check if it matches the
structure symbol.</p></li>
<li><p><strong>structure_symbol</strong> – The structure symbol to check if it matches
the pattern symbol.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the symbols can be mapped and False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.permutation.MappingMatrix.min_mapping_symbol">
<span class="sig-name descname"><span class="pre">min_mapping_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#fgutils.permutation.MappingMatrix.min_mapping_symbol" title="Link to this definition"></a></dt>
<dd><p>This function finds the symbol with the lowest permutation count.
Take <code class="docutils literal notranslate"><span class="pre">[A,</span> <span class="pre">A,</span> <span class="pre">B]</span></code> and <code class="docutils literal notranslate"><span class="pre">[A,</span> <span class="pre">A,</span> <span class="pre">A,</span> <span class="pre">B,</span> <span class="pre">B]</span></code> as pattern and symbol lists
for example. The function will return <code class="docutils literal notranslate"><span class="pre">B</span></code>, because there are only 2
possible mappings whereas for <code class="docutils literal notranslate"><span class="pre">A</span></code> there are 6. This is useful to find
suitable anchor nodes in pattern matching. It is 3x as fast to anchor
<code class="docutils literal notranslate"><span class="pre">B</span></code> and check the alighment then anchoring <code class="docutils literal notranslate"><span class="pre">A</span></code>. The min mapping
excludes zero mappings. If there is no mapping possible at all None
is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern_symbols</strong> – The list of pattern symbols.</p></li>
<li><p><strong>structure_symbols</strong> – The list of structure symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tuple of symbols with the lowest permutation count. The
first entry is the pattern symbol and the second entry is the
structure symbol. If no mapping is found at all None is returned.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.permutation.PermutationMapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.permutation.</span></span><span class="sig-name descname"><span class="pre">PermutationMapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wildcard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_case</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">can_map_to_nothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.permutation.PermutationMapper" title="Link to this definition"></a></dt>
<dd><p>The Permutation Mapper class specifies how nodes can match. The wildcard
is specified for the pattern characters and not the structure characters.
This means that the wildcard will only match in the direction Pattern -&gt;
Structure. The <code class="docutils literal notranslate"><span class="pre">R</span></code> as wildcard and <code class="docutils literal notranslate"><span class="pre">C</span></code> as normal label for example.
<code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">-&gt;</span> <span class="pre">C</span></code> will match but <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code> will not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wildcard</strong> – (optional) The wildcard is a specific pattern node label
that can match to any other node. In the chemical notation this would
be the R group, e.g., RC(=O)OH for an acid.</p></li>
<li><p><strong>ignore_case</strong> – (optional) Flag if the matching of node labels is case
insensitive. Default: False</p></li>
<li><p><strong>can_map_to_nothing</strong> – (optional) A list of characters that can map to
nothing. A node with a label in this list does not need a mapping at
all. For example optional nodes that can or can not have a mapping.
This is different to the wildcard in the sense that a wildcard must map
to node (with an arbitrary label though).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.proxy">
<span id="proxy"></span><h2>proxy<a class="headerlink" href="#module-fgutils.proxy" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.GraphSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">GraphSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.GraphSampler" title="Link to this definition"></a></dt>
<dd><p>Base class for sampling ProxyGraphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unique</strong> – If set to true each graph is only returned once. (Default =
False)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.GraphSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#fgutils.proxy.GraphSampler.sample" title="Link to this definition"></a></dt>
<dd><p>Method to retrive a new sample from a list of graphs. If unique is set
to true the first graph that was not yet returned is selected. None is
returned if all graphs have been selected. If unique is false all
graphs are returned each time the function is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graphs</strong> – A list of graphs to sample from.</p></li>
<li><p><strong>group_name</strong> – (optional) The group name is an optional argument.
It’s not necessary to specify it if it’s not needed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns one or more graphs from the list or None if sampling
should stop.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.MolProxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">MolProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.MolProxy" title="Link to this definition"></a></dt>
<dd><p>Proxy to generate molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>core</strong> – A pattern string or ProxyGroup representing the core graph.
For example a specific functional group.</p></li>
<li><p><strong>groups</strong> – A list of groups to expand the core graph with.</p></li>
<li><p><strong>parser</strong> – (optional) The parser to convert patterns into structures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.Proxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">Proxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_aam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.Proxy" title="Link to this definition"></a></dt>
<dd><p>Proxy is a generator class. It extends a specific core graph by a set
of subgraphs (groups). This class implements the iterator interface so it
can be used in a for loop to generate samples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">proxy</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">(</span><span class="s2">&quot;C</span><span class="si">{g}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ProxyGroup</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="n">proxy</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;symbol&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="go">[&#39;C&#39;, &#39;C&#39;]</span>
<span class="go">[&#39;C&#39;, &#39;O&#39;]</span>
<span class="go">[&#39;C&#39;, &#39;N&#39;]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>core</strong> – A pattern string or ProxyGroup representing the core graph.
For example a specific functional group or a reaction center.</p></li>
<li><p><strong>groups</strong> – A list of groups to expand the core graph with.</p></li>
<li><p><strong>enable_aam</strong> – Flag to specify if the ‘aam’ label is set in the result
graph. (Default = True)</p></li>
<li><p><strong>parser</strong> – (optional) The parser to convert patterns into structures.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.Proxy.from_dict">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fgutils.proxy.Proxy" title="fgutils.proxy.Proxy"><span class="pre">Proxy</span></a></span></span><a class="headerlink" href="#fgutils.proxy.Proxy.from_dict" title="Link to this definition"></a></dt>
<dd><p>Load Proxy from dict config. The expected JSON format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;core&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span> <span class="c1"># for expected format take a</span>
    <span class="c1"># look at ProxyGroup.from_dict()</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – The configuration dictionary. E.g. loaded from JSON</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The instantiated Proxy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.Proxy.get_next">
<span class="sig-name descname"><span class="pre">get_next</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.Proxy.get_next" title="Link to this definition"></a></dt>
<dd><p>Get the next sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A generated graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fgutils.proxy.Proxy.groups">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fgutils.proxy.Proxy.groups" title="Link to this definition"></a></dt>
<dd><p>The list of ProxyGroups. This can be set with values of the
following type: <code class="docutils literal notranslate"><span class="pre">ProxyGroup</span> <span class="pre">|</span> <span class="pre">list[ProxyGroup]</span> <span class="pre">|</span> <span class="pre">dict[str,</span>
<span class="pre">ProxyGroup]</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGraph">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">ProxyGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.ProxyGraph" title="Link to this definition"></a></dt>
<dd><p>ProxyGraph is essentially a subgraph used to expand molecules. If the node
that is replaced by the pattern has more edges than the pattern has
anchors, the last anchor will be used multiple times. In the default case
the first node in the pattern will connect to all the neighboring nodes of
the replaced node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – String representation of the graph.</p></li>
<li><p><strong>anchor</strong> – A list of indices in the pattern that are used to
connect to the parent graph. (Default = [0])</p></li>
<li><p><strong>name</strong> – A name for the graph. This is just for visualization and
debugging.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments are used as graph properties. Specify
whatever you need.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGroup">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">ProxyGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graphs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.ProxyGroup" title="Link to this definition"></a></dt>
<dd><p>ProxyGroup is a collection of patterns that can be replaced for a labeled
node in a graph. The node label is the respective group name where one of
the patterns will be replaced</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the group.</p></li>
<li><p><strong>graphs</strong> – (optional) A list of subgraphs or a list of graph
descriptions. The patterns are converted to ProxyGraphs with one anchor
at index 0. Use ProxyGraph objects if you need more control over how
subgraphs are instantiated.</p></li>
<li><p><strong>sampler</strong> – (optional) An object or a function to retrive individual
graphs from the list. The expected function interface is:
<code class="docutils literal notranslate"><span class="pre">func(list[ProxyGraph])</span> <span class="pre">-&gt;</span> <span class="pre">list[ProxyGraph]</span></code>. Implement the
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> method if you use a class. The function can have an
optional keyword argument <strong>group_name</strong>.</p></li>
<li><p><strong>unique</strong> – Argument to specify if graphs can be returned multiple
times. This only takes effect if sampler is not set. (Default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGroup.from_dict">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.proxy.ProxyGroup.from_dict" title="Link to this definition"></a></dt>
<dd><p>Load ProxyGroups from dict config. The expected JSON format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;group_name_1&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;group_name_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">],</span>
    <span class="s2">&quot;group_name_3&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group_config</span><span class="o">&gt;</span> <span class="c1"># for expected format take a</span>
    <span class="c1"># look at ProxyGroup.from_dict_single()</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – The configuration dictionary. E.g. loaded from JSON
file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a mapping dictionary of ProxyGroups where the key is
the group name and the value is the ProxyGroup object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGroup.from_dict_single">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a></span></span><a class="headerlink" href="#fgutils.proxy.ProxyGroup.from_dict_single" title="Link to this definition"></a></dt>
<dd><p>Load a single ProxyGroup object from configuration. The expected
JSON format is one of the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="c1"># short form</span>
    <span class="s2">&quot;graphs&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;graphs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">],</span>
    <span class="s2">&quot;graphs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">,</span> <span class="s2">&quot;anchor&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]},</span>
    <span class="c1"># complete config</span>
    <span class="s2">&quot;graphs&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="s2">&quot;anchor&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
            <span class="o">&lt;</span><span class="n">any_key</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">any_value</span><span class="o">&gt;</span>
        <span class="p">}],</span>

    <span class="c1"># &lt;pattern&gt; is the SMILES-like graph description of type str</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It’s possible to specify additional properties on graphs. These can be
used for example by custom samplers to implement some logic or
dependencies between groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the ProxyGroup.</p></li>
<li><p><strong>config</strong> – The configuration dictionary. E.g. loaded from JSON
file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The instantiated ProxyGroup.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGroup.graphs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">graphs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fgutils.proxy.ProxyGroup.graphs" title="Link to this definition"></a></dt>
<dd><p>The list of ProxyGraphs. This can be set with values of the
following type: <code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">|</span> <span class="pre">list[str]</span> <span class="pre">|</span> <span class="pre">ProxyGraph</span> <span class="pre">|</span> <span class="pre">list[ProxyGraph]</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.ProxyGroup.sample_graphs">
<span class="sig-name descname"><span class="pre">sample_graphs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#fgutils.proxy.ProxyGroup.sample_graphs" title="Link to this definition"></a></dt>
<dd><p>Sample graphs. This method uses the sampler to select a list of
graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of ProxyGraph objects or None if there is nothing more
to sample.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.proxy.ReactionProxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">ReactionProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_aam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.ReactionProxy" title="Link to this definition"></a></dt>
<dd><p>Proxy to generate reactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>core</strong> – A pattern string or ProxyGroup representing the core graph.
For example a specific functional group or a reaction center.</p></li>
<li><p><strong>groups</strong> – A list of groups to expand the core graph with.</p></li>
<li><p><strong>enable_aam</strong> – Flag to specify if the ‘aam’ label is set in the result
graph. (Default = True)</p></li>
<li><p><strong>parser</strong> – (optional) The parser to convert patterns into structures.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.proxy.ReactionProxy.get_next">
<span class="sig-name descname"><span class="pre">get_next</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.ReactionProxy.get_next" title="Link to this definition"></a></dt>
<dd><p>Generate a new reaction sample. The reaction proxy returns two graphs G
and H. G is the reactant graph and H is the product graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of two graphs (G, H) representing the reaction G
→ H.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.proxy.build_graphs">
<span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">build_graphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.build_graphs" title="Link to this definition"></a></dt>
<dd><p>Replace labeled nodes in the core graph with groups. For each labeled
node the respective group is used to replace the node by the specified
subgraphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>core</strong> – The parent graph with labeled nodes.</p></li>
<li><p><strong>groups</strong> – A list of groups to replace the labeled nodes in the core
graph with. The dictionary keys must be the group names.</p></li>
<li><p><strong>parser</strong> – The parser that is used to convert graph patterns into
graphs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of graphs with replaced nodes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.proxy.build_group_tree">
<span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">build_group_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.proxy.build_group_tree" title="Link to this definition"></a></dt>
<dd><p>Constructs a tree of all possible graph instantiations. The number of leave
nodes in this tree is the number of possible samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>core</strong> – The ProxyGroup that serves as core group.</p></li>
<li><p><strong>groups</strong> – A list of groups to replace labeled nodes.</p></li>
<li><p><strong>parser</strong> – (optional) A parser to use for conversion from pattern to
structures.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the construction tree as nx.Graph object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.proxy.replace_next_node">
<span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">replace_next_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.proxy.ProxyGroup" title="fgutils.proxy.ProxyGroup"><span class="pre">ProxyGroup</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.replace_next_node" title="Link to this definition"></a></dt>
<dd><p>Replace the next labeled node in graph with the respective group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph where a node should be replace by a subgraph.</p></li>
<li><p><strong>groups</strong> – A mapping dictionary of groups to replace the labeled nodes
in the parent with. The dictionary keys must be the group name.</p></li>
<li><p><strong>parser</strong> – The parser to use to convert the pattern into structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of new graphs where the first labeled node is
replaced. None is returned if no replaceable labeled node is left.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.proxy.replace_node">
<span class="sig-prename descclassname"><span class="pre">fgutils.proxy.</span></span><span class="sig-name descname"><span class="pre">replace_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replacement_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.proxy.ProxyGraph" title="fgutils.proxy.ProxyGraph"><span class="pre">ProxyGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.parse.Parser" title="fgutils.parse.Parser"><span class="pre">Parser</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy.replace_node" title="Link to this definition"></a></dt>
<dd><p>Replace node in graph with replacement_graph converted by the parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph where a node should be replace by a subgraph.</p></li>
<li><p><strong>node</strong> – The node to replace in graph.</p></li>
<li><p><strong>replacement_graph</strong> – The subgraph that is inserted instead of the
node.</p></li>
<li><p><strong>parser</strong> – The parser to convert the pattern into structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a new graph with <code class="docutils literal notranslate"><span class="pre">node</span></code> replace by
<code class="docutils literal notranslate"><span class="pre">replacement_graph</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.proxy_collection.common">
<span id="proxy-collection"></span><h2>proxy_collection<a class="headerlink" href="#module-fgutils.proxy_collection.common" title="Link to this heading"></a></h2>
<dl class="py class" id="module-fgutils.proxy_collection.diels_alder_proxy">
<dt class="sig sig-object py" id="fgutils.proxy_collection.diels_alder_proxy.DielsAlderProxy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.proxy_collection.diels_alder_proxy.</span></span><span class="sig-name descname"><span class="pre">DielsAlderProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enable_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.proxy_collection.diels_alder_proxy.DielsAlderProxy" title="Link to this definition"></a></dt>
<dd><p>A proxy for the generation of Diels-Alder reaction samples and
counter-samples. The proxy returns two graphs G and H as tuple. G is the
reactant graph and H is the product graph. For a comprehensive description
of the proxy configuration read section <a class="reference internal" href="proxy_collection.html#diels-alder-reaction-proxy"><span class="std std-ref">Diels-Alder Reaction Proxy</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable_aam</strong> – Flag to specify if the <code class="docutils literal notranslate"><span class="pre">aam</span></code> label is set in the
result graphs. (Default = True)</p></li>
<li><p><strong>neg_sample</strong> – If set to true the proxy will exclusively generate
negative samples, i.e., reactions where a Diels-Alder graph
transformation rule is theoretically applicable but the reaction will
never happen in reality. (Default = False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.query">
<span id="query"></span><h2>query<a class="headerlink" href="#module-fgutils.query" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.query.FGQuery">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.query.</span></span><span class="sig-name descname"><span class="pre">FGQuery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.permutation.PermutationMapper" title="fgutils.permutation.PermutationMapper"><span class="pre">PermutationMapper</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.fgconfig.FGConfig" title="fgutils.fgconfig.FGConfig"><span class="pre">FGConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.fgconfig.FGConfig" title="fgutils.fgconfig.FGConfig"><span class="pre">FGConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.fgconfig.FGConfigProvider" title="fgutils.fgconfig.FGConfigProvider"><span class="pre">FGConfigProvider</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_implicit_hydrogen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.query.FGQuery" title="Link to this definition"></a></dt>
<dd><p>Class to get functional groups from a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapper</strong> – (optional) The permutation mapper to use.</p></li>
<li><p><strong>config_provider</strong> – (optional) A functional group config provider. If
not specified the default functional group collection will be used.</p></li>
<li><p><strong>require_implicit_hydrogen</strong> – Flag to specify if implicit hydrogens are
required for the query. This usually depends on the provided FGConfigs.
If the configured functional group patterns do not require hydrogens
this can be set to false. (Default = True)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.query.FGQuery.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.query.FGQuery.get" title="Link to this definition"></a></dt>
<dd><p>Get all functional groups from a molecule. The query returns two
functional groups for acetylsalicylic acid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="s2">&quot;O=C(C)Oc1ccccc1C(=O)O&quot;</span> <span class="c1"># acetylsalicylic acid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">FGQuery</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="go">[(&#39;ester&#39;, [0, 1, 3]), (&#39;carboxylic_acid&#39;, [10, 11, 12])]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – This is either a graph or SMILES as string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of tuples. The first element in a tuple is the
functional group name and the second element is a list of node
indices that belong to this functional group
<code class="docutils literal notranslate"><span class="pre">(functional_group_name,</span> <span class="pre">[idx_1,</span> <span class="pre">idx_2,</span> <span class="pre">...])</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fgutils.rdkit">
<span id="rdkit"></span><h2>rdkit<a class="headerlink" href="#module-fgutils.rdkit" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.get_mol_coords">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">get_mol_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.rdkit.get_mol_coords" title="Link to this definition"></a></dt>
<dd><p>Try to get a molecule like coordinate representation of the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – The graph to get the coordinates for.</p></li>
<li><p><strong>scale</strong> – (optional) A scale for the coordinates. (Default: 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a dict of coordinates. The keys are the node indices and
the values are the 2 coordinates x and y.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.graph_to_mol">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">graph_to_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mol</span></span></span><a class="headerlink" href="#fgutils.rdkit.graph_to_mol" title="Link to this definition"></a></dt>
<dd><p>Convert a graph to an RDKit molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – The molecule as node and edge labeled graph. The graph requires
<code class="docutils literal notranslate"><span class="pre">SYMBOL</span></code> node labels and <code class="docutils literal notranslate"><span class="pre">BOND_KEY</span></code> edge labels. The node label
<code class="docutils literal notranslate"><span class="pre">AAM_KEY</span></code> is optional to annotate the molecule with an atom-atom map.</p></li>
<li><p><strong>ignore_aam</strong> – If set to true the atom-atom map will not be
initialized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the graph as RDKit molecule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.graph_to_smiles">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">graph_to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fgutils.rdkit.graph_to_smiles" title="Link to this definition"></a></dt>
<dd><p>Convert a molecular graph into a SMILES string. This function uses
RDKit for SMILES generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – Graph to convert to SMILES representation.</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
<li><p><strong>ignore_aam</strong> – If set to True the returned SMILES has no atom-atom map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the SMILES.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.mol_smiles_to_graph">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">mol_smiles_to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.rdkit.mol_smiles_to_graph" title="Link to this definition"></a></dt>
<dd><p>Converts a SMILES to a graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> – SMILES to convert to graph(s).</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
<li><p><strong>h_nodes</strong> – Flag to control if Hydrogens are added as nodes. If set to
False neither implicit nor explicit Hydrogens are added. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A node and edge labeled molecular graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.mol_to_graph">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">mol_to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.rdkit.mol_to_graph" title="Link to this definition"></a></dt>
<dd><p>Convert an RDKit molecule to a graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – An RDKit molecule.</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
<li><p><strong>h_nodes</strong> – Flag to control if Hydrogens are added as nodes. If set to
False neither implicit nor explicit Hydrogens are added. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The molecule as node and edge labeled graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.reaction_smiles_to_graph">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">reaction_smiles_to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.rdkit.reaction_smiles_to_graph" title="Link to this definition"></a></dt>
<dd><p>Converts a reaction SMILES to the graph representation G → H,
where G is the reactant graph and H is the product graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> – Reaction SMILES to convert to graph tuple.</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
<li><p><strong>h_nodes</strong> – Flag to control if Hydrogens are added as nodes. If set to
False neither implicit nor explicit Hydrogens are added. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the graphs G and H as tuple.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.rdkit.smiles_to_graph">
<span class="sig-prename descclassname"><span class="pre">fgutils.rdkit.</span></span><span class="sig-name descname"><span class="pre">smiles_to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.rdkit.smiles_to_graph" title="Link to this definition"></a></dt>
<dd><p>Converts a SMILES to a graph. If the SMILES encodes a reaction a graph
tuple is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> – SMILES to convert to graph(s).</p></li>
<li><p><strong>implicit_h</strong> – Flag to add all Hydrogen atoms. (Default: False)</p></li>
<li><p><strong>h_nodes</strong> – Flag to control if Hydrogens are added as nodes. If set to
False neither implicit nor explicit Hydrogens are added. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A molecular graph or graph tuple if SMILES is a reaction SMILES.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.synthesis.rule_application">
<span id="synthesis"></span><h2>synthesis<a class="headerlink" href="#module-fgutils.synthesis.rule_application" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.DPORule">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.synthesis.rule_application.</span></span><span class="sig-name descname"><span class="pre">DPORule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rule_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.synthesis.rule_application.DPORule" title="Link to this definition"></a></dt>
<dd><p>Double Pushout Rule class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rule_id</strong> – The id of the rule. This can also be seen as the rule name.</p></li>
<li><p><strong>left</strong> – The left graph L in the DPO rule <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">←</span> <span class="pre">C</span> <span class="pre">→</span> <span class="pre">R</span></code>.</p></li>
<li><p><strong>context</strong> – The context graph C in the DPO rule <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">←</span> <span class="pre">C</span> <span class="pre">→</span> <span class="pre">R</span></code>.</p></li>
<li><p><strong>right</strong> – The right graph R in the DPO rule <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">←</span> <span class="pre">C</span> <span class="pre">→</span> <span class="pre">R</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.DPORule.to_rc_graph">
<span class="sig-name descname"><span class="pre">to_rc_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.synthesis.rule_application.DPORule.to_rc_graph" title="Link to this definition"></a></dt>
<dd><p>Method to convert the DPO rule representation to a reaction center
graph, i.e., the superposition of L and R on C. The reaction center
graph is a node and edge labeled graph. The <code class="docutils literal notranslate"><span class="pre">BOND_KEY</span></code> edge label
encodes the bond change in the reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns the reaction center graph.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.ReactionRule">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.synthesis.rule_application.</span></span><span class="sig-name descname"><span class="pre">ReactionRule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unnamed</span> <span class="pre">rule'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.synthesis.rule_application.ReactionRule" title="Link to this definition"></a></dt>
<dd><p>Class describing a reaction rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc_graph</strong> – A reaction center graph.</p></li>
<li><p><strong>name</strong> – (optional) The name of the reaction rule.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.ReactionRule.from_gml">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_gml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.synthesis.rule_application.ReactionRule.from_gml" title="Link to this definition"></a></dt>
<dd><p>Load reaction rule from a GML file. Supported format is the MØD GML
rule format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – This can be either a file path or a GML string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns an instance of the ReactionRule class.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.apply_rule">
<span class="sig-prename descclassname"><span class="pre">fgutils.synthesis.rule_application.</span></span><span class="sig-name descname"><span class="pre">apply_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fgutils.synthesis.rule_application.ReactionRule" title="fgutils.synthesis.rule_application.ReactionRule"><span class="pre">ReactionRule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connected_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fgutils.its.ITS" title="fgutils.its.ITS"><span class="pre">ITS</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.synthesis.rule_application.apply_rule" title="Link to this definition"></a></dt>
<dd><p>Apply a reaction rule to a reactant graph G. The function returns the
generated ITS graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – The reactant graph. This can be a disconnected graph for multiple
reactant molecules.</p></li>
<li><p><strong>rule</strong> – The reaction rule to apply to the reactant graph.</p></li>
<li><p><strong>n</strong> – (optional) Limits the maximum number of solutions. If n is set to
an integer it will return once n solutions are found. (Default: None)</p></li>
<li><p><strong>unique</strong> – (optional) Flag to specify if isomorphic solutions should be
returned as one solution. Isomorphism is checked with 3 iterations WL.</p></li>
<li><p><strong>connected_only</strong> – (optional) Flag to specify if the ITS graph must be
connected. Setting this to true means that all reactants in g must take
part in the reaction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of ITS graphs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.its_to_gml">
<span class="sig-prename descclassname"><span class="pre">fgutils.synthesis.rule_application.</span></span><span class="sig-name descname"><span class="pre">its_to_gml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">its</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.synthesis.rule_application.its_to_gml" title="Link to this definition"></a></dt>
<dd><p>Convert an ITS graph into DPO GML string format. The ITS graph needs
SYMBOL_KEY node features and BOND_KEY edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>its</strong> – The ITS graph to convert to GML.</p></li>
<li><p><strong>rule_id</strong> – The DPO rule id.</p></li>
<li><p><strong>indent</strong> – The number of spaces used for indentation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a list of strings where each string represents one line
in the GML file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.synthesis.rule_application.parse_gml_dpo_rule">
<span class="sig-prename descclassname"><span class="pre">fgutils.synthesis.rule_application.</span></span><span class="sig-name descname"><span class="pre">parse_gml_dpo_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fgutils.synthesis.rule_application.DPORule" title="fgutils.synthesis.rule_application.DPORule"><span class="pre">DPORule</span></a></span></span><a class="headerlink" href="#fgutils.synthesis.rule_application.parse_gml_dpo_rule" title="Link to this definition"></a></dt>
<dd><p>Parse a GML string into a DPO rule object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lines</strong> – The lines of the GML string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the parsed DPO rule.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.torch.ITSDataset">
<span id="torch"></span><h2>torch<a class="headerlink" href="#module-fgutils.torch.ITSDataset" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fgutils.torch.ITSDataset.ITSDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.torch.ITSDataset.</span></span><span class="sig-name descname"><span class="pre">ITSDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.its.ITS" title="fgutils.its.ITS"><span class="pre">ITS</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.ITSDataset.ITSDataset" title="Link to this definition"></a></dt>
<dd><p>Instantiates a torch.Dataset from a list of ITS graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The list of ITS graphs to create the dataset from.</p></li>
<li><p><strong>y</strong> – (optional) The list of ITS labels. These are the prediction
targets. This list must be of the same length as the ITS graphs.</p></li>
<li><p><strong>ids</strong> – (optional) A list of IDs. The number of IDs must be equal to
the number of graphs. Default: None</p></li>
<li><p><strong>node_feature_transform</strong> – (optional) A transform function to convert
node attributes to a node feature vector. Default: None</p></li>
<li><p><strong>edge_feature_transform</strong> – (optional) A transform function to convert
edge attributes to an edge feature vector. Default: None</p></li>
<li><p><strong>pre_transform</strong> – (optional) A callback function to transform the
Tensor representation of the ITS graph before it is stored. This
function is executed only once on initialization.</p></li>
<li><p><strong>transform</strong> – (optional) A callback function to transform the
Tensor representation of the ITS graph when accessed. This function is
executed on every access.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-fgutils.torch.TUDataset">
<dt class="sig sig-object py" id="fgutils.torch.TUDataset.TUDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fgutils.torch.TUDataset.</span></span><span class="sig-name descname"><span class="pre">TUDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_node_attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_edge_attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.TUDataset.TUDataset" title="Link to this definition"></a></dt>
<dd><p>Class for reading datasets in the
[TUDataset](<a class="reference external" href="https://chrsmrrs.github.io/datasets/docs/format/">https://chrsmrrs.github.io/datasets/docs/format/</a>) file format.
This implementation is copied and modified from
[torch_geometric.datasets.TUDataset](<a class="reference external" href="https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.datasets.TUDataset.html">https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.datasets.TUDataset.html</a>)
to also support instance IDs for easier identification of samples. IDs are
loaded from an additional ids.txt file where the i-th line is the id of the
i-th graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> – Root directory where the dataset is saved.</p></li>
<li><p><strong>name</strong> – The name of the dataset.</p></li>
<li><p><strong>transform</strong> – A function/transform that takes in a data object and
returns a transformed version. The data object will be transformed
before every access. (default: None)</p></li>
<li><p><strong>pre_transform</strong> – A function/transform that takes in
a data object and returns a transformed version. The data object
will be transformed before being saved to disk. (default: None)</p></li>
<li><p><strong>pre_filter</strong> – A function that takes in an data object and returns
a boolean value, indicating whether the data object should be
included in the final dataset. (default: None)</p></li>
<li><p><strong>force_reload</strong> – Whether to re-process the dataset. (default:
False)</p></li>
<li><p><strong>use_node_attr</strong> – If True, the dataset will contain additional
continuous node attributes (if present). (default: False)</p></li>
<li><p><strong>use_edge_attr</strong> – If True, the dataset will contain additional
continuous edge attributes (if present). (default: False)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fgutils.torch.TUDataset.TUDataset.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.TUDataset.TUDataset.download" title="Link to this definition"></a></dt>
<dd><p>Downloads the dataset to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.raw_dir</span></code> folder.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fgutils.torch.TUDataset.TUDataset.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fgutils.torch.TUDataset.TUDataset.process" title="Link to this definition"></a></dt>
<dd><p>Processes the dataset to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.processed_dir</span></code> folder.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fgutils.torch.TUDataset.TUDataset.processed_file_names">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">processed_file_names</span></span><a class="headerlink" href="#fgutils.torch.TUDataset.TUDataset.processed_file_names" title="Link to this definition"></a></dt>
<dd><p>The name of the files in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.processed_dir</span></code> folder that
must be present in order to skip processing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fgutils.torch.TUDataset.TUDataset.raw_file_names">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw_file_names</span></span><a class="headerlink" href="#fgutils.torch.TUDataset.TUDataset.raw_file_names" title="Link to this definition"></a></dt>
<dd><p>The name of the files in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.raw_dir</span></code> folder that must
be present in order to skip downloading.</p>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-fgutils.torch.graph">
<dt class="sig sig-object py" id="fgutils.torch.graph.edge_induced_subgraph">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.graph.</span></span><span class="sig-name descname"><span class="pre">edge_induced_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.graph.edge_induced_subgraph" title="Link to this definition"></a></dt>
<dd><p>Get an edge induced subgraph form the torch graph representation. Keep
in mind that the returned node indices (e.g. in the edge_index tensor) are
not the same as in the input graph. This is because the node indices are
implicit in the row number of the node features and hence a relabeling is
necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph from which to get a edge induced subgraph.</p></li>
<li><p><strong>edges</strong> – A list of edge indices for the induced subgraph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Node induced subgraph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.torch.graph.node_induced_subgraph">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.graph.</span></span><span class="sig-name descname"><span class="pre">node_induced_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.graph.node_induced_subgraph" title="Link to this definition"></a></dt>
<dd><p>Get a node induced subgraph form the torch graph representation. Keep
in mind that the returned node indices (e.g. in the edge_index tensor) are
not the same as in the input graph. This is because the node indices are
implicit in the row number of the node features and hence a relabeling is
necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph from which to get a node induced subgraph.</p></li>
<li><p><strong>nodes</strong> – A list of node indices for the induced subgraph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Node induced subgraph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-fgutils.torch.utils">
<dt class="sig sig-object py" id="fgutils.torch.utils.get_adjacency_matrix">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.utils.</span></span><span class="sig-name descname"><span class="pre">get_adjacency_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#fgutils.torch.utils.get_adjacency_matrix" title="Link to this definition"></a></dt>
<dd><p>Get the adjacency matrix from a torch data sample. The sample needs
property <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">edge_index</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample</strong> – The torch data sample.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the adjacency matrix as tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.torch.utils.its_from_torch">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.utils.</span></span><span class="sig-name descname"><span class="pre">its_from_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.utils.its_from_torch" title="Link to this definition"></a></dt>
<dd><p>Convert an ITS in PyTorch data format back into the NetworkX ITS format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – The PyTorch data to convert. This can be a single sample or a
batch of samples.</p></li>
<li><p><strong>node_feature_transform</strong> – (optional) A transform function to convert
the node features back into the atom symbol. The function gets the node
feature tensor as argument and is expected to return the atom symbol
for that node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sample ITS graph or a list of ITS graph if data is a batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.torch.utils.its_to_torch">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.utils.</span></span><span class="sig-name descname"><span class="pre">its_to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">its</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.its.ITS" title="fgutils.its.ITS"><span class="pre">ITS</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#fgutils.its.ITS" title="fgutils.its.ITS"><span class="pre">ITS</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Batch</span></span></span><a class="headerlink" href="#fgutils.torch.utils.its_to_torch" title="Link to this definition"></a></dt>
<dd><p>Convert an ITS graph or a list of ITS graphs to the PyTorch data format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>its</strong> – The ITS graph to convert. If it is a single ITS graph the
return type will be Data. For a list of ITS graphs a Batch is returned.</p></li>
<li><p><strong>node_feature_transform</strong> – (optional) A transform function to convert
the node annotations into a node feature vector. The function gets the
node dict as argument and is expected to return a torch.Tensor node
feature vector.</p></li>
<li><p><strong>edge_feature_transform</strong> – (optional) A transform function to convert
the edge annotations into an edge feature vector. The function gets the
edge dict as argument and is expected to return a torch.Tensor edge
feature vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sample ITS graph or a list of ITS graph if data is a batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.torch.utils.prune">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.utils.</span></span><span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Data</span></span></span><a class="headerlink" href="#fgutils.torch.utils.prune" title="Link to this definition"></a></dt>
<dd><p>Prune the graph represented as torch data sample. This function removes
all nodes that are <code class="docutils literal notranslate"><span class="pre">radius</span></code> farther away from a set of <code class="docutils literal notranslate"><span class="pre">start_nodes</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> – The torch data sample.</p></li>
<li><p><strong>start_nodex</strong> – A list of start node indices.</p></li>
<li><p><strong>radius</strong> – (optional) The maximum path length of nodes to keep around
the start nodes. Every node with a longer shortes path to any start
node is removed from the graph. Default: 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pruned graph as torch data sample.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.torch.utils.prune_rc">
<span class="sig-prename descclassname"><span class="pre">fgutils.torch.utils.</span></span><span class="sig-name descname"><span class="pre">prune_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.torch.utils.prune_rc" title="Link to this definition"></a></dt>
<dd><p>Prune the torch data ITS graph represented. This function removes
all nodes that are <code class="docutils literal notranslate"><span class="pre">radius</span></code> farther away from the reaction center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> – The torch data sample.</p></li>
<li><p><strong>radius</strong> – (optional) The maximum path length of nodes to keep around
the reaction center. Every node with a longer shortes path to any node
in the reaction center is removed from the graph. Default: 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pruned graph as torch data sample.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-fgutils.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.add_implicit_hydrogens">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">add_implicit_hydrogens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.utils.add_implicit_hydrogens" title="Link to this definition"></a></dt>
<dd><p>Add implicit hydrogens as dedicated nodes to graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The mol graph to add hydrogens to.</p></li>
<li><p><strong>inplace</strong> – (optional) Inplace will change the input instance. When set
to False the returned instance is a copy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the molecular graph with implicit hydrogens or a copy if
inplace is False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.complete_aam">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">complete_aam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.utils.complete_aam" title="Link to this definition"></a></dt>
<dd><p>Complete the atom-atom map on a graph based on node indices. This
function does not override an existing atom-atom map. It extends the
existing atom-atom map to all nodes. The numbering of the new nodes starts
at 1 or <code class="docutils literal notranslate"><span class="pre">offset</span></code> and skipps all existing mapping numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph where to complete the atom-atom map.</p></li>
<li><p><strong>offset</strong> – (optional) The mapping offset. Offset is the first value
used for numbering. If set to <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code> the offset will be set to the
lowest existing number.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.get_product">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">get_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fgutils.utils.get_product" title="Link to this definition"></a></dt>
<dd><p>Function to get the product SMILES from a reaction SMILES. If the input
is not a reaction the full input is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> – The input (reaction) SMILES.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the product SMILES.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.get_reactant">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">get_reactant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_reagent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fgutils.utils.get_reactant" title="Link to this definition"></a></dt>
<dd><p>Get the reactant string from a reaction SMILES. If the input is not a
reaction the full string is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> – The input SMILES.</p></li>
<li><p><strong>include_reagent</strong> – Flag to select if reagents provided as
‘&gt;[reagents]&gt;’ should be included in the reactants. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the reactant SMILES.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.get_unreachable_nodes">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">get_unreachable_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.utils.get_unreachable_nodes" title="Link to this definition"></a></dt>
<dd><p>Get the list of nodes that can not be reached from start nodes within a
given distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – The graph for which to get unreachable nodes.</p></li>
<li><p><strong>start_nodes</strong> – A list of nodes to start from. Start nodes count as
radius 0. For a reachable node there must exist a path from a start
node with at most radius number of steps.</p></li>
<li><p><strong>radius</strong> – The maximum number of hops from start_nodes. (Default: 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the list of unreachable nodes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.initialize_aam">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">initialize_aam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fgutils.utils.initialize_aam" title="Link to this definition"></a></dt>
<dd><p>Initialize atom-atom map on a graph based on node indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The graph where to initialize the atom-atom map.</p></li>
<li><p><strong>offset</strong> – (optional) The mapping offset. Offset is the first value
used for numbering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.mol_equal">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">mol_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fgutils.utils.mol_equal" title="Link to this definition"></a></dt>
<dd><p>Compare a candidate molecule to a specific target molecule. The
result is true if the candidate matches the target. The
comparison is done with 3 iterations WL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> – A candidate molecule.</p></li>
<li><p><strong>target</strong> – A target molecule to compare to.</p></li>
<li><p><strong>compare_mode</strong> – (optional) The compare mode: “target”, “candidate”,
“largest_target”, “largest_candidate”, or “both”. For “target” its
sufficient that the candidate matches all components in the target, for
“candidate” its sufficient that the target matches all candidate
components and for “both” a complete match must be found. For the two
largest_* compare modes only the respective largest component needs to
find a match. This is helpful to ignore additional small compounds.
(Default: both)</p></li>
<li><p><strong>iterations</strong> – (optional) The number of Weisfeiler-Leman iterations.
(Default: 3)</p></li>
<li><p><strong>ignore_hydrogens</strong> – (optional) Flag to ignore hydrogens in the
comparison. Molecules with unequal hydrogen configurations will count
as identical. (Default: False)</p></li>
<li><p><strong>min_atoms</strong> – (optional) The minimum number of atoms a component needs
to have to be considered in the comparison. This can be useful to
exlude small molecules like water. (Default: 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the candidate matches the target and else otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.remove_implicit_hydrogens">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">remove_implicit_hydrogens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#fgutils.utils.remove_implicit_hydrogens" title="Link to this definition"></a></dt>
<dd><p>Remove implicit hydrogens as dedicated nodes to graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The mol graph to remove hydrogens to.</p></li>
<li><p><strong>inplace</strong> – (optional) Inplace will change the input instance. When set
to False the returned instance is a copy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the molecular graph with implicit hydrogens removed or a
copy if inplace is False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fgutils.utils.split_its">
<span class="sig-prename descclassname"><span class="pre">fgutils.utils.</span></span><span class="sig-name descname"><span class="pre">split_its</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fgutils.utils.split_its" title="Link to this definition"></a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Deprecated since v0.1.6. This function was moved to module fgutils.its.
It will be removed from fgutils.utils in the future.</p>
</div>
<p>Split an ITS graph into reactant graph G and product graph H. Required
labels on the ITS graph are BOND_KEY.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong> – ITS graph to split up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of two graphs (G, H).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fgutils.vis">
<span id="vis"></span><h2>vis<a class="headerlink" href="#module-fgutils.vis" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="proxy_collection.html" class="btn btn-neutral float-left" title="Proxy Collection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Klaus Weinbauer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>